<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>demo</title>

    <style>
        .list div {
            padding-left: 20px;
        }
    </style>
</head>
<body>
<div id="test" class="list"></div>

<script src="js/jquery-2.1.4.min.js"></script>
<script src="js/jquery.imenu.js"></script>

<script>
    var menu = new $("#test").IMenu();

    var addNodeOptionTemplate = $("<button>");

    addNodeOptionTemplate.text("Add Node");
    addNodeOptionTemplate.on("click", {menu: menu}, function (e) {
        var node = $(this).data("node");

        if (typeof node.nodes === "undefined") {
            node.nodes = [];
        }

        node.nodes.push({
            dom: $("<div>").text("node - " + (node.nodes.length + 1)),
            options: [
                addNodeOptionTemplate,
                removeNodeOptionTemplate
            ]
        });

        e.data.menu.update();
    });

    var removeNodeOptionTemplate = $("<button>");

    removeNodeOptionTemplate.text("Remove Node");
    removeNodeOptionTemplate.on("click", {menu: menu}, function (e) {
        var node = $(this).data("node");

        node.remove = true;

        e.data.menu.update();
    });

    var nodeTemplate = {
        name: "root",
        dom: $("<div>")
                .text("root"),

        options: [
            addNodeOptionTemplate,
            removeNodeOptionTemplate
        ]
    };

    menu.node = nodeTemplate;

    menu.update();

</script>

</body>
</html>